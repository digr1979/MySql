#######################################################################
#
#  File:  ozon_desc.txt
#  Author: Dmitry Gromov
#  Date: 2021-05-08
#  Description: Course project - short description for on-line marketplace a-la ozon.ru
#
#######################################################################

Набросок интернет-магазина. За пример взят www.ozon.ru

Модель на данный момент позволяет:
1. Содержать данные по товарным позициям привязанным к соответсвующим категориям
2. Содержать описание товарных позиций, в том числе с использованием фотографий
3. Вести учет заказов и возвратов товаров.
4. Содержать отзывы на товар, задавать вопросы и получать ответы с привязкой фотографий.
5. Вести рейтинг товаров на основе отзывов покупателей.

Модель состоит из следующих таблиц:
1. `mediatypes` - Таблица используется для указания типа использования фотографий в таблице `mediadata` 
2. `profiles`- Таблица содержит данные профиля покупателя не предназначенные для открытого доступа
3. `users`- Таблица `users` - информация о логине и публичное представление
4. `categories`- таблица содержит категории и подкатегории товаров. Данные взяты с сайта www.ozon.ru и для получения результатов запросов имеющих смысл.
5. `products`- Таблица товаров. Содержит основную информацию по товарам. Данные взяты с ozon.ru и имеют смысл
				Поля `cummulative_rating` и `total_reviews` заполняются по триггерам на таблицу `reviews`
6. `mediadata`- таблица используется для привязки фотографий к описаниям, отзывам, возвратам и т. д.
				т. е. для описания товаров используются одни фотографии, для отзывов другие  и т. д.
7. `photos`- Таблица с фотографиями. Вынес в отдельную таблицу, так как возможны разные варианты хранения достаточно больших бинарных объектов
8. `discussions`- Таблица содержит вопросы и ответы по товарам
9. `orders`- Общая информация по заказам. Подробности по каждой строке заказа содержатся в таблице `orderdetails`
10. `orderdetails`- Таблица содержит детальную информацию о каждом заказе
11. `returns`- Таблица содержит общую информацию по возвратам товаров. Подробности  по каждой строке возврата содержатся в таблице `returndetails`
12. `returndetails`- Таблица содержит детальную информацию о возврате 
13. `reviews`- Таблица с отзывами на товар. К данной таблице привязаны триггеры `ins_review` и `del_review`
				при добавлении/удалении отзыва, пересчитывается рейтинг и кол-во отзывов в таблице `products`  
                
К некоторым таблицам добавлены индексы.                

Реализованы индексы `ins_review` и `del_review` на таблицу `reviews`
при добавлении/удалении отзыва, они выполняют пересчёт рейтинга и кол-ва отзывов в таблице `products`      

Реализована хранимая процедура `sp_getdiscussion`- 'Возвращает все существующие ветки обсуждений по указанному товару, посредством вызова рекурсивного cte.'

Реализованы два представления:
1. `ratings` - отображает изменение рейтинга товара с каждым новым отзывом (как суммарного, так и среднего) используя оконные фуункции
2. `toptencustomersbyrevenue` - отображает топ 10 покупателей, совершивших покупки на большую общую сумму



        
